requests:
  totalNumberOfVulnarabilities:
    query: SELECT COUNT(1) FROM Issues WHERE Level = 'Error'
  totalNumberOfLowVulnarabilities:
    query: SELECT COUNT(*) AS totalNumberOfValnurableDependencies
           FROM Issues as i INNER JOIN IssueProperties as ip ON i.Id = ip.IssueId
           WHERE i.Level = 'Error' AND ip.Property = 'score' AND ip.Value <= 4
  totalNumberOfMediumVulnarabilities:
    query: SELECT COUNT(*) AS totalNumberOfValnurableDependencies
           FROM Issues as i INNER JOIN IssueProperties as ip ON i.Id = ip.IssueId
           WHERE i.Level = 'Error' AND ip.Property = 'score' AND ip.Value > 4 AND ip.Value <= 8
  totalNumberOfHighVulnarabilities:
    query: SELECT COUNT(*) AS totalNumberOfValnurableDependencies
           FROM Issues as i INNER JOIN IssueProperties as ip ON i.Id = ip.IssueId
           WHERE i.Level = 'Error' AND ip.Property = 'score' AND ip.Value > 8
  totalNumberOfDependencies:
    query: SELECT COUNT(DISTINCT il.FilePath) AS totalNumberOfValnurableDependencies
           FROM Issues as i INNER JOIN IssueLocations as il ON i.Id = il.IssueId
  totalNumberOfVulnarabelDependencies:
    query: SELECT COUNT(DISTINCT il.FilePath) AS totalNumberOfValnurableDependencies
           FROM Issues as i INNER JOIN IssueLocations as il ON i.Id = il.IssueId
           WHERE i.Level = 'Error'
  vulnerableDependencies:
    query: SELECT i.RuleId, i.Message, i.Description, i.DetailsUrl, il.FilePath, ip.Severity ROW_NUMBER() OVER() AS number
           FROM Issues as i 
           INNER JOIN IssueLocations as il ON i.Id = il.IssueId
           INNER JOIN IssueProperties as ip ON i.Id = ip.IssueId
           WHERE i.Level = 'Error'
           ORDERED BY ip.Property
    type: Collection